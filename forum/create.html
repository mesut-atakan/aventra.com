<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Notion-Style Forum Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <style>
        body {
            background: linear-gradient(to right, #2B0B3F, #6E2B6D);
            color: #23272e;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
        }

        .sidebar {
            width: 210px;
            background: rgba(255,255,255,0.91);
            box-shadow: 3px 0 14px #2B0B3F12;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            gap: 1.6rem;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            z-index: 10;
            min-height: 100vh;
        }

        .accordion {
            background: none;
            border: none;
            padding: 0;
        }

        .accordion-title {
            font-size: 1.11rem;
            font-weight: bold;
            color: #311948;
            margin-bottom: .7rem;
            display: flex;
            align-items: center;
            cursor: pointer;
            gap: 7px;
        }

        .accordion-content {
            display: none;
            flex-direction: column;
            gap: .5rem;
            margin-bottom: .5rem;
        }

        .accordion.open .accordion-content {
            display: flex;
        }

        .menu-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f4f4ff;
            border: none;
            color: #2B0B3F;
            font-size: 1rem;
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            transition: background .14s;
        }

            .menu-btn:hover {
                background: #FFEDCC;
            }

            .menu-btn span {
                font-size: .93em;
                color: #877e93;
            }

        .main-area {
            margin-left: 230px;
            flex: 1;
            padding: 3rem 0 2rem 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .editor-box {
            width: 100%;
            max-width: 600px;
            background: rgba(255,255,255,0.97);
            border-radius: 13px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.09);
            padding: 2.5rem 2.1rem;
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        .editor-title {
            font-size: 2rem;
            font-weight: bold;
            outline: none;
            border: none;
            width: 100%;
            color: #2B0B3F;
            background: none;
            margin-bottom: .6rem;
        }

            .editor-title:empty:before {
                content: "Başlık yazın...";
                color: #bbb;
                font-weight: 400;
            }

        .editor-content {
            min-height: 100px;
            background: none;
            outline: none;
            border: none;
            width: 100%;
            font-size: 1.15rem;
            color: #312144;
            margin-bottom: 0;
        }

            .editor-content:empty:before {
                content: "Açıklama (opsiyonel)";
                color: #bbb;
                font-style: italic;
            }

        .code-block {
            width: 100%;
            min-height: 40px;
            background: #23272e;
            color: #f8f8f2;
            font-family: "Fira Mono", "Consolas", "Monaco", monospace;
            border-radius: 7px;
            padding: 11px 14px;
            font-size: .99em;
            resize: vertical;
            margin: 7px 0;
            border: none;
            outline: none;
        }

        .submit-btn {
            margin-top: 2.2rem;
            padding: .85rem 1.7rem;
            font-size: 1.1rem;
            font-weight: bold;
            background: #FF6600;
            color: #fff;
            border: none;
            border-radius: 9px;
            letter-spacing: .1px;
            cursor: pointer;
            transition: background .18s;
        }

            .submit-btn:disabled {
                background: #ff9146;
                cursor: not-allowed;
            }

        @media (max-width: 850px) {
            .sidebar {
                display: none;
            }

            .main-area {
                margin: 0;
                padding: 1rem;
            }
        }

        /* FLOATING TOOLBAR MODERN UI */
        .float-toolbar-ui {
            z-index: 2222;
            padding: 7px 14px;
            border-radius: 11px;
            background: #fff;
            box-shadow: 0 6px 22px #2b0b3f17, 0 0 0 1.5px #e2d6ff;
            display: flex;
            align-items: center;
            gap: 7px;
            opacity: 0;
            pointer-events: none;
            position: absolute;
            min-height: 36px;
            transition: opacity 0.18s, box-shadow 0.18s;
            border: 1.2px solid #F0E5FF;
        }

            .float-toolbar-ui.show {
                opacity: 1;
                pointer-events: auto;
            }

            .float-toolbar-ui .toolbar-btn {
                border: none;
                background: none;
                padding: 6px 10px;
                margin: 0 1.5px;
                font-size: 1.06em;
                color: #2B0B3F;
                border-radius: 6px;
                cursor: pointer;
                transition: background .12s, color .14s;
                font-family: inherit;
                font-weight: 600;
                outline: none;
                line-height: 1.05;
            }

                .float-toolbar-ui .toolbar-btn:focus,
                .float-toolbar-ui .toolbar-btn:hover {
                    background: #F4EDE9;
                    color: #FF6600;
                }

                .float-toolbar-ui .toolbar-btn i,
                .float-toolbar-ui .toolbar-btn b,
                .float-toolbar-ui .toolbar-btn u,
                .float-toolbar-ui .toolbar-btn s {
                    font-size: 1.1em;
                    vertical-align: middle;
                }

        /* Color Palette Bar Styles */
        .palette-bar {
            display: flex;
            gap: 2px;
            padding: 0 3px;
        }

        .palette-btn {
            width: 18px;
            height: 18px;
            border: 1.5px solid #e1d8fa;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 1px;
            transition: border .12s, box-shadow .13s;
            outline: none;
        }

            .palette-btn:hover,
            .palette-btn:focus {
                border: 1.5px solid #391859;
                box-shadow: 0 0 3px #FF660088;
            }

        @media (max-width: 700px) {
            .float-toolbar-ui {
                min-height: 28px;
                padding: 5px 4px;
                font-size: .98em;
                gap: 2px;
            }

                .float-toolbar-ui .toolbar-btn {
                    padding: 4px 5px;
                    font-size: .96em;
                }

            .palette-btn {
                width: 14px;
                height: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="accordion open">
            <div class="accordion-title" onclick="toggleAccordion(this)">Tipi Değiştir <i class="fa fa-angle-down"></i></div>
            <div class="accordion-content">
                <button class="menu-btn" onclick="formatBlock('h1')"><i class="fa fa-header"></i> <span>Başlık (H1)</span></button>
                <button class="menu-btn" onclick="formatBlock('h2')"><i class="fa fa-header"></i> <span>Başlık (H2)</span></button>
                <button class="menu-btn" onclick="formatBlock('h3')"><i class="fa fa-header"></i> <span>Başlık (H3)</span></button>
                <button class="menu-btn" onclick="formatBlock('p')"><i class="fa fa-paragraph"></i> <span>Paragraf</span></button>
                <button class="menu-btn" onclick="document.execCommand('insertUnorderedList')"><i class="fa fa-list-ul"></i> <span>Madde Listesi</span></button>
                <button class="menu-btn" onclick="document.execCommand('insertOrderedList')"><i class="fa fa-list-ol"></i> <span>Numaralı Liste</span></button>
                <button class="menu-btn" onclick="insertTodo()"><i class="fa fa-check-square-o"></i> <span>To-Do List</span></button>
                <button class="menu-btn" onclick="insertCallout()"><i class="fa fa-info-circle"></i> <span>Callout</span></button>
                <button class="menu-btn" onclick="insertDivider()"><i class="fa fa-minus"></i> <span>Ayraç</span></button>
                <button class="menu-btn" onclick="insertCodeBlock()"><i class="fa fa-code"></i> <span>Kod Bloğu</span></button>
                <!-- Sol Bar'da (accordion-content) şunları ekle -->
                <button class="menu-btn" onclick="setBold()"><b>B</b> <span>Kalın</span></button>
                <button class="menu-btn" onclick="setItalic()"><i>I</i> <span>İtalik</span></button>
                <button class="menu-btn" onclick="setUnderline()"><u>U</u> <span>Altı Çizili</span></button>
                <button class="menu-btn" onclick="setStrike()"><s>S</s> <span>Üstü Çizili</span></button>
                <button class="menu-btn" onclick="setLink()"><i class="fa fa-link"></i> <span>Bağlantı</span></button>
                <button class="menu-btn" onclick="insertImage()"><i class="fa fa-image"></i> <span>Fotoğraf</span></button>

            </div>
        </div>
        <div class="accordion">
            <div class="accordion-title" onclick="toggleAccordion(this)">Satır İşlemleri <i class="fa fa-angle-down"></i></div>
            <div class="accordion-content">
                <button class="menu-btn" onclick="deleteLine()"><i class="fa fa-trash"></i> <span>Satırı Sil</span></button>
                <button class="menu-btn" onclick="pickColor('color')"><i class="fa fa-paint-brush"></i> <span>Yazı Rengi</span></button>
                <button class="menu-btn" onclick="pickColor('backgroundColor')"><i class="fa fa-paint-brush"></i> <span>Arka Plan Rengi</span></button>
                <button class="menu-btn" onclick="duplicateLine()"><i class="fa fa-copy"></i> <span>Kopyala</span></button>
            </div>
        </div>
    </div>
    <div class="main-area">
        <form class="editor-box" onsubmit="return handleSubmit(event)">
            <div id="editorTitle" class="editor-title" contenteditable="true"></div>
            <div id="editorContent" class="editor-content" contenteditable="true"></div>
            <button type="submit" class="submit-btn" id="submitBtn" disabled>Forum Sayfasını Oluştur</button>
        </form>
    </div>
   <script>
// Accordion açma-kapama
function toggleAccordion(el) {
    const parent = el.closest('.accordion');
    document.querySelectorAll('.accordion').forEach(acc => acc.classList.remove('open'));
    parent.classList.toggle('open');
}

// Başlık kontrolü
const editorTitle = document.getElementById('editorTitle');
const editorContent = document.getElementById('editorContent');
const submitBtn = document.getElementById('submitBtn');
editorTitle.addEventListener('input', () => {
    submitBtn.disabled = editorTitle.innerText.trim().length < 1;
});

// Tipi Değiştir (Sol Bar)
function formatBlock(tag) {
    document.execCommand('formatBlock', false, tag);
    editorContent.focus();
}
function insertImage() {
    const url = prompt("Görselin internet adresini yapıştır:");
    if (url) document.execCommand('insertImage', false, url);
}
function setBold() { document.execCommand('bold', false, null); }
function setItalic() { document.execCommand('italic', false, null); }
function setUnderline() { document.execCommand('underline', false, null); }
function setStrike() { document.execCommand('strikeThrough', false, null); }
function setLink() {
    const url = prompt('Bağlantı girin:');
    if (url) document.execCommand('createLink', false, url);
}

// Kod Bloğu (Notion-Style, <pre>)
function insertCodeBlock() {
    const pre = document.createElement('pre');
    pre.className = 'code-block';
    pre.setAttribute('contenteditable', 'true');
    pre.innerHTML = '<br>';
    pre.style.whiteSpace = 'pre-wrap';
    pre.addEventListener('keydown', function(e) {
        // Shift+Enter ile kod bloğundan çık, altına yeni satır ekle ve odakla
        if (e.key === "Enter" && e.shiftKey) {
            e.preventDefault();
            const p = document.createElement('div');
            p.innerHTML = '<br>';
            if (pre.nextSibling) editorContent.insertBefore(p, pre.nextSibling);
            else editorContent.appendChild(p);
            setTimeout(() => setCaretAtStart(p), 0);
        }
    });
    pre.addEventListener('focus', function(e) {
        setTimeout(() => {
            if (pre.innerHTML === '<br>' || pre.innerHTML === '') setCaretAtStart(pre);
        }, 0);
    });
    insertNodeAtCursor(pre);
    // Altına ekstra satır ekle
    const p = document.createElement('div');
    p.innerHTML = '<br>';
    if (pre.nextSibling) editorContent.insertBefore(p, pre.nextSibling);
    else editorContent.appendChild(p);
    setCaretAtStart(pre);
}
function insertNodeAtCursor(node) {
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    const range = sel.getRangeAt(0);
    range.collapse(false);
    range.insertNode(node);
    range.setStart(node, 0);
    range.setEnd(node, 0);
    sel.removeAllRanges();
    sel.addRange(range);
}
function setCaretAtStart(el) {
    const range = document.createRange();
    range.setStart(el, 0);
    range.collapse(true);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
}

// Diğer blok tipleri
function insertCallout() {
    document.execCommand('insertHTML', false, `<div style="background:#FFF5C2;color:#2B0B3F;padding:12px 18px;border-radius:8px;margin:5px 0;">💡 Bilgi Kutusu</div>`);
}
function insertDivider() {
    document.execCommand('insertHTML', false, `<hr style="border:0;height:1.5px;background:#E6D5B8;margin:18px 0;">`);
}
function insertTodo() {
    document.execCommand('insertHTML', false, `<div contenteditable="false" style="display:inline-block;vertical-align:middle;"><input type="checkbox" style="zoom:1.3;margin-right:7px;vertical-align:middle;"></div>`);
}

// Satır İşlemleri
function getActiveLineNode() {
    let sel = window.getSelection();
    if (!sel.rangeCount) return null;
    let node = sel.anchorNode;
    while (node && node !== editorContent && node.nodeType !== 1) node = node.parentNode;
    if (node === editorContent) return null;
    return node;
}
function deleteLine() {
    const line = getActiveLineNode();
    if (line) line.remove();
}
function duplicateLine() {
    const line = getActiveLineNode();
    if (line) {
        const clone = line.cloneNode(true);
        line.after(clone);
    }
}
function pickColor(type) {
    const line = getActiveLineNode();
    if (!line) return;
    const input = document.createElement('input');
    input.type = 'color';
    input.style.position = 'fixed';
    input.style.left = '-9999px';
    document.body.appendChild(input);
    input.onchange = e => {
        line.style[type] = input.value;
        input.remove();
    };
    input.click();
}

// FLOATING TOOLBAR UI
const COLORS = [
    "#000000","#E53935","#FFB300","#43A047","#1E88E5",
    "#3949AB","#F4511E","#8D6E63","#00897B","#FDD835","#C2185B"
];
const toolbarActions = [
    { icon: '<b>B</b>', cmd: 'bold', title: 'Kalın' },
    { icon: '<i>I</i>', cmd: 'italic', title: 'İtalik' },
    { icon: '<u>U</u>', cmd: 'underline', title: 'Altı Çizili' },
    { icon: '<s>S</s>', cmd: 'strikeThrough', title: 'Üstü Çizili' },
    { icon: '<i class="fa fa-link"></i>', cmd: 'createLink', prompt: 'Bağlantı girin:', title: 'Bağlantı' },
    { icon: '<code style="background:#ececec;padding:2px 6px;border-radius:4px;font-size:.9em;">{}</code>', custom: 'inlineCode', title: 'Kodu Vurgula' }
];
function colorPalette(cmd, colors=COLORS) {
    let html = '<div class="palette-bar">';
    colors.forEach(c => {
        html += `<button class="palette-btn" style="background:${c}" title="${c}" onclick="paletteColorPick(event,'${cmd}','${c}')"></button>`;
    });
    html += '</div>';
    return html;
}
const floatToolbar = document.createElement('div');
floatToolbar.className = 'float-toolbar-ui';
document.body.appendChild(floatToolbar);
function showFloatToolbar() {
    const sel = window.getSelection();
    if (!sel.rangeCount || sel.isCollapsed || document.activeElement !== editorContent) {
        floatToolbar.style.opacity = 0;
        floatToolbar.style.pointerEvents = 'none';
        return;
    }
    const range = sel.getRangeAt(0);
    const rect = range.getBoundingClientRect();
    floatToolbar.innerHTML = '';
    toolbarActions.forEach(action => {
        const btn = document.createElement('button');
        btn.innerHTML = action.icon;
        btn.className = 'toolbar-btn';
        btn.title = action.title;
        btn.onclick = e => {
            e.preventDefault();
            if (action.cmd) {
                if (action.cmd === 'createLink') {
                    const url = prompt(action.prompt);
                    if (url) document.execCommand(action.cmd, false, url);
                } else {
                    document.execCommand(action.cmd, false, null);
                }
            }
            if (action.custom === 'inlineCode') {
                document.execCommand('insertHTML', false, `<code style="background:#ececec;padding:2px 6px;border-radius:4px;">${sel.toString()}</code>`);
            }
            floatToolbar.style.opacity = 0;
            floatToolbar.style.pointerEvents = 'none';
        };
        floatToolbar.appendChild(btn);
    });
    // Renk paleti - yazı rengi
    const colorWrap = document.createElement('div');
    colorWrap.innerHTML = colorPalette('foreColor');
    colorWrap.style.display = 'inline-block';
    colorWrap.style.marginLeft = '9px';
    floatToolbar.appendChild(colorWrap);
    // Renk paleti - arka plan rengi
    const bgWrap = document.createElement('div');
    bgWrap.innerHTML = colorPalette('hiliteColor');
    bgWrap.style.display = 'inline-block';
    bgWrap.style.marginLeft = '2px';
    floatToolbar.appendChild(bgWrap);

    // Pozisyon
    floatToolbar.style.position = 'absolute';
    floatToolbar.style.top = (window.scrollY + rect.top - 48) + "px";
    floatToolbar.style.left = (window.scrollX + rect.left + rect.width / 2 - 120) + "px";
    floatToolbar.style.opacity = 1;
    floatToolbar.style.pointerEvents = 'auto';
}
editorContent.addEventListener('mouseup', showFloatToolbar);
editorContent.addEventListener('keyup', showFloatToolbar);
window.addEventListener('mousedown', (e) => {
    if (!floatToolbar.contains(e.target)) {
        floatToolbar.style.opacity = 0;
        floatToolbar.style.pointerEvents = 'none';
    }
});
window.paletteColorPick = function(e, cmd, color) {
    e.preventDefault();
    document.execCommand(cmd, false, color);
    floatToolbar.style.opacity = 0;
    floatToolbar.style.pointerEvents = 'none';
};

// H1, H2, H3 Boyutları
const style = document.createElement('style');
style.innerHTML = `
    #editorContent h1 { font-size:2.2rem;font-weight:900;margin:15px 0 7px 0;color:#2B0B3F;}
    #editorContent h2 { font-size:1.5rem;font-weight:700;margin:13px 0 6px 0;color:#391859;}
    #editorContent h3 { font-size:1.15rem;font-weight:700;margin:11px 0 5px 0;color:#71499c;}
`;
document.head.appendChild(style);

// Forum Gönderimi
function handleSubmit(event) {
    event.preventDefault();
    const title = editorTitle.innerText.trim();
    let content = editorContent.innerHTML.trim();
    if (typeof createEntry === "function") createEntry(title, content);
    return false;
};


    </script>
</body>
</html>